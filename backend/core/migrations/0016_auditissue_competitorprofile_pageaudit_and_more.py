# Generated by Django 4.2.7 on 2025-11-26 09:51

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('core', '0015_alter_herosection_options'),
    ]

    operations = [
        migrations.CreateModel(
            name='AuditIssue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('audit_id', models.CharField(help_text='Lighthouse audit ID', max_length=100)),
                ('title', models.CharField(max_length=300)),
                ('description', models.TextField()),
                ('category', models.CharField(choices=[('performance', 'Performance'), ('seo', 'SEO'), ('accessibility', 'Accessibility'), ('best-practices', 'Best Practices')], max_length=30)),
                ('severity', models.CharField(choices=[('error', 'Error'), ('warning', 'Warning'), ('info', 'Info'), ('passed', 'Passed')], max_length=20)),
                ('score', models.FloatField(blank=True, help_text='Audit score (0-1)', null=True)),
                ('display_value', models.CharField(blank=True, help_text='Human-readable value', max_length=200)),
                ('savings_ms', models.FloatField(default=0, help_text='Potential time savings in ms')),
                ('savings_bytes', models.IntegerField(default=0, help_text='Potential size savings in bytes')),
                ('status', models.CharField(choices=[('open', 'Open'), ('in_progress', 'In Progress'), ('fixed', 'Fixed'), ('ignored', 'Ignored')], default='open', max_length=20)),
                ('ai_fix_recommendation', models.TextField(blank=True, help_text='ChatGPT fix recommendation')),
                ('fixed_at', models.DateTimeField(blank=True, null=True)),
                ('details', models.JSONField(blank=True, default=dict)),
            ],
            options={
                'verbose_name': 'Audit Issue',
                'ordering': ['severity', '-savings_ms'],
            },
        ),
        migrations.CreateModel(
            name='CompetitorProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('domain', models.CharField(max_length=255, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('domain_authority', models.IntegerField(default=0)),
                ('organic_traffic_est', models.IntegerField(default=0)),
                ('total_keywords', models.IntegerField(default=0)),
                ('total_backlinks', models.IntegerField(default=0)),
                ('last_analysis', models.DateTimeField(blank=True, null=True)),
                ('analysis_data', models.JSONField(blank=True, default=dict)),
                ('ai_insights', models.TextField(blank=True)),
                ('notes', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Competitor Profile',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='PageAudit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('url', models.URLField(db_index=True, max_length=500)),
                ('strategy', models.CharField(default='mobile', max_length=10)),
                ('performance_score', models.IntegerField(blank=True, null=True)),
                ('accessibility_score', models.IntegerField(blank=True, null=True)),
                ('best_practices_score', models.IntegerField(blank=True, null=True)),
                ('seo_score', models.IntegerField(blank=True, null=True)),
                ('lcp', models.FloatField(blank=True, help_text='Largest Contentful Paint (seconds)', null=True)),
                ('fid', models.FloatField(blank=True, help_text='First Input Delay (milliseconds)', null=True)),
                ('inp', models.FloatField(blank=True, help_text='Interaction to Next Paint (milliseconds)', null=True)),
                ('cls', models.FloatField(blank=True, help_text='Cumulative Layout Shift', null=True)),
                ('fcp', models.FloatField(blank=True, help_text='First Contentful Paint (seconds)', null=True)),
                ('ttfb', models.FloatField(blank=True, help_text='Time to First Byte (milliseconds)', null=True)),
                ('si', models.FloatField(blank=True, help_text='Speed Index (seconds)', null=True)),
                ('tbt', models.FloatField(blank=True, help_text='Total Blocking Time (milliseconds)', null=True)),
                ('raw_data', models.JSONField(blank=True, default=dict)),
                ('status', models.CharField(default='pending', max_length=20)),
                ('error_message', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Page Audit',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SearchConsoleSync',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('property_url', models.URLField(help_text='Search Console property URL', max_length=255)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('rows_imported', models.IntegerField(default=0)),
                ('queries_imported', models.IntegerField(default=0)),
                ('pages_imported', models.IntegerField(default=0)),
                ('error_message', models.TextField(blank=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Search Console Sync',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SiteAudit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=200)),
                ('domain', models.CharField(default='codeteki.au', max_length=255)),
                ('strategy', models.CharField(choices=[('mobile', 'Mobile'), ('desktop', 'Desktop')], default='mobile', max_length=10)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('target_urls', models.JSONField(blank=True, default=list, help_text='List of URLs to audit')),
                ('avg_performance', models.FloatField(blank=True, null=True)),
                ('avg_seo', models.FloatField(blank=True, null=True)),
                ('avg_accessibility', models.FloatField(blank=True, null=True)),
                ('avg_best_practices', models.FloatField(blank=True, null=True)),
                ('total_pages', models.IntegerField(default=0)),
                ('total_issues', models.IntegerField(default=0)),
                ('critical_issues', models.IntegerField(default=0)),
                ('warning_issues', models.IntegerField(default=0)),
                ('ai_analysis', models.TextField(blank=True, help_text='ChatGPT analysis of audit results')),
                ('ai_recommendations', models.JSONField(blank=True, default=list)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Site Audit',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SEORecommendation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('target_url', models.URLField(blank=True, max_length=500)),
                ('target_field', models.CharField(blank=True, help_text='Field to update (e.g., meta_title)', max_length=100)),
                ('recommendation_type', models.CharField(choices=[('meta_title', 'Meta Title'), ('meta_description', 'Meta Description'), ('content_brief', 'Content Brief'), ('technical_fix', 'Technical Fix'), ('new_content', 'New Content'), ('internal_link', 'Internal Link')], max_length=30)),
                ('title', models.CharField(max_length=255)),
                ('current_value', models.TextField(blank=True)),
                ('recommended_value', models.TextField()),
                ('reasoning', models.TextField(blank=True)),
                ('priority', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low')], default='medium', max_length=20)),
                ('status', models.CharField(choices=[('generated', 'Generated'), ('pending', 'Pending Review'), ('approved', 'Approved'), ('applied', 'Applied'), ('rejected', 'Rejected')], default='generated', max_length=20)),
                ('applied_at', models.DateTimeField(blank=True, null=True)),
                ('ai_model', models.CharField(blank=True, max_length=50)),
                ('ai_tokens_used', models.IntegerField(default=0)),
                ('audit_issue', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='recommendations', to='core.auditissue')),
                ('cluster', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='seo_recommendations', to='core.seokeywordcluster')),
                ('keyword', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='seo_recommendations', to='core.seokeyword')),
                ('upload', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='seo_recommendations', to='core.seodataupload')),
            ],
            options={
                'verbose_name': 'SEO Recommendation',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SEOChatSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('session_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('context', models.JSONField(blank=True, default=dict)),
                ('title', models.CharField(blank=True, max_length=255)),
                ('audit', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.siteaudit')),
                ('upload', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.seodataupload')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'SEO Chat Session',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='SEOChatMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('role', models.CharField(choices=[('user', 'User'), ('assistant', 'Assistant'), ('system', 'System')], max_length=20)),
                ('content', models.TextField()),
                ('data_references', models.JSONField(blank=True, default=list)),
                ('tokens_used', models.IntegerField(default=0)),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='core.seochatsession')),
            ],
            options={
                'verbose_name': 'SEO Chat Message',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='SEOChangeLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('target_url', models.URLField(max_length=500)),
                ('target_field', models.CharField(max_length=100)),
                ('old_value', models.TextField()),
                ('new_value', models.TextField()),
                ('applied_at', models.DateTimeField(auto_now_add=True)),
                ('reverted', models.BooleanField(default=False)),
                ('reverted_at', models.DateTimeField(blank=True, null=True)),
                ('applied_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('recommendation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='change_logs', to='core.seorecommendation')),
            ],
            options={
                'verbose_name': 'SEO Change Log',
                'ordering': ['-applied_at'],
            },
        ),
        migrations.CreateModel(
            name='ScheduledAudit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=200)),
                ('is_active', models.BooleanField(default=True)),
                ('target_urls', models.JSONField(default=list, help_text='List of URLs to audit')),
                ('strategy', models.CharField(default='mobile', max_length=10)),
                ('frequency', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly')], default='weekly', max_length=20)),
                ('last_run', models.DateTimeField(blank=True, null=True)),
                ('next_run', models.DateTimeField(blank=True, null=True)),
                ('notify_emails', models.JSONField(blank=True, default=list, help_text='Email addresses for notifications')),
                ('notify_on_score_drop', models.BooleanField(default=True)),
                ('score_drop_threshold', models.IntegerField(default=5, help_text='Alert if score drops by this many points')),
                ('last_audit', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='scheduled_for', to='core.siteaudit')),
            ],
            options={
                'verbose_name': 'Scheduled Audit',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='PageSpeedResult',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('url', models.URLField(db_index=True, max_length=500)),
                ('strategy', models.CharField(default='mobile', max_length=10)),
                ('lab_performance_score', models.IntegerField(blank=True, null=True)),
                ('lab_lcp', models.FloatField(blank=True, null=True)),
                ('lab_fcp', models.FloatField(blank=True, null=True)),
                ('lab_cls', models.FloatField(blank=True, null=True)),
                ('lab_tbt', models.FloatField(blank=True, null=True)),
                ('lab_si', models.FloatField(blank=True, null=True)),
                ('field_lcp', models.FloatField(blank=True, help_text='75th percentile LCP from real users', null=True)),
                ('field_fid', models.FloatField(blank=True, help_text='75th percentile FID from real users', null=True)),
                ('field_inp', models.FloatField(blank=True, help_text='75th percentile INP from real users', null=True)),
                ('field_cls', models.FloatField(blank=True, help_text='75th percentile CLS from real users', null=True)),
                ('field_fcp', models.FloatField(blank=True, help_text='75th percentile FCP from real users', null=True)),
                ('field_ttfb', models.FloatField(blank=True, help_text='75th percentile TTFB from real users', null=True)),
                ('origin_lcp', models.FloatField(blank=True, null=True)),
                ('origin_inp', models.FloatField(blank=True, null=True)),
                ('origin_cls', models.FloatField(blank=True, null=True)),
                ('overall_category', models.CharField(blank=True, help_text='FAST, AVERAGE, or SLOW', max_length=20)),
                ('raw_data', models.JSONField(blank=True, default=dict)),
                ('page_audit', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='pagespeed_results', to='core.pageaudit')),
            ],
            options={
                'verbose_name': 'PageSpeed Result',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='pageaudit',
            name='site_audit',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='page_audits', to='core.siteaudit'),
        ),
        migrations.AddField(
            model_name='auditissue',
            name='page_audit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='issues', to='core.pageaudit'),
        ),
        migrations.CreateModel(
            name='SearchConsoleData',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('date', models.DateField(db_index=True)),
                ('query', models.CharField(db_index=True, max_length=500)),
                ('page', models.URLField(max_length=500)),
                ('clicks', models.IntegerField(default=0)),
                ('impressions', models.IntegerField(default=0)),
                ('ctr', models.FloatField(default=0, help_text='Click-through rate (0-1)')),
                ('position', models.FloatField(default=0, help_text='Average position in search results')),
                ('country', models.CharField(blank=True, max_length=10)),
                ('device', models.CharField(blank=True, max_length=20)),
                ('upload', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='search_console_data', to='core.seodataupload')),
            ],
            options={
                'verbose_name': 'Search Console Data',
                'verbose_name_plural': 'Search Console Data',
                'ordering': ['-date', '-impressions'],
                'indexes': [models.Index(fields=['date', 'query'], name='core_search_date_e32c54_idx'), models.Index(fields=['page', 'date'], name='core_search_page_0f62c8_idx')],
            },
        ),
        migrations.CreateModel(
            name='KeywordRanking',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('date', models.DateField(db_index=True)),
                ('position', models.FloatField()),
                ('previous_position', models.FloatField(blank=True, null=True)),
                ('position_change', models.FloatField(default=0)),
                ('clicks', models.IntegerField(default=0)),
                ('impressions', models.IntegerField(default=0)),
                ('ctr', models.FloatField(default=0)),
                ('ranking_url', models.URLField(blank=True, max_length=500)),
                ('has_featured_snippet', models.BooleanField(default=False)),
                ('has_local_pack', models.BooleanField(default=False)),
                ('has_video', models.BooleanField(default=False)),
                ('has_image', models.BooleanField(default=False)),
                ('serp_features', models.JSONField(blank=True, default=list)),
                ('keyword', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='rankings', to='core.seokeyword')),
            ],
            options={
                'verbose_name': 'Keyword Ranking',
                'ordering': ['-date', 'position'],
                'indexes': [models.Index(fields=['keyword', 'date'], name='core_keywor_keyword_32166a_idx')],
            },
        ),
    ]
